import{f as e,_ as o,k as l,u as s,p as a,q as i,v as t,o as n,c as d,a as c,h as g,b as m,w as f,F as u,r,e as p,g as y,t as v}from"./index-80b41754.js";import"./main.d2a90dc7.js";const b=o({name:"index.vue",components:{},data:()=>({login:{dialog:!0,form:{uid:"",psw:""}},msg:{list:null,form:{msg:""}}}),created(){},mounted(){this.login.form.uid=l("uid")},methods:{sendMsg(){s({data:"1"+this.msg.form.msg,success:function(){console.log("消息发送成功")},fail:function(){console.log("消息发送失败")}}),this.msg.form.msg=""},loginUser(){let o=this;var s;(s=this.login.form,e({url:`https://dominant-ant-formerly.ngrok-free.app/mpc/user/login/${s.uid}/${s.psw}`,method:"GET"})).then((e=>{if(200==e.data.code){a("token",e.data.data),a("uid",this.login.form.uid),this.$message.success("登录成功");const s=l("token");i({url:`wss://dominant-ant-formerly.ngrok-free.app/mpc?token=${s}`,success:function(){console.log("WebSocket连接成功"),t((e=>{console.log(e.data),o.msg.list=JSON.parse(e.data).list})),o.login.dialog=!1},fail:function(){console.log("WebSocket连接失败"),o.$message.fail("登录失败")}})}else this.$message.fail("登录失败")}))},encodeImage(e){console.log("encodeImage");const o=e.target.files[0],l=new FileReader;l.onloadend=()=>{const e=l.result.replace(/^data:.+;base64,/,"");s({data:"2"+e,success:function(){console.log("消息发送成功")},fail:function(){console.log("消息发送失败")}}),this.msg.form.msg=""},l.readAsDataURL(o)}}},[["render",function(e,o,l,s,a,i){const t=p("el-input"),b=p("el-button"),h=p("el-avatar"),k=p("el-form-item"),V=p("el-form"),_=p("el-dialog");return n(),d("div",null,[c("div",{style:{},ref:""},[g("      <div>"),g('        <input type="file" id="file-input" @change="encodeImage">'),g("      </div>"),c("div",{style:{display:"flex"}},[m(t,{modelValue:a.msg.form.msg,"onUpdate:modelValue":o[0]||(o[0]=e=>a.msg.form.msg=e),autocomplete:"off"},null,8,["modelValue"]),m(b,{onClick:i.sendMsg},{default:f((()=>[y("发送")])),_:1},8,["onClick"])]),c("div",{class:"box"},[(n(!0),d(u,null,r(a.msg.list,(e=>(n(),d("div",{class:"box"},[e.uid==a.login.form.uid?(n(),d("div",{key:0,class:"chatBoxMessageRight"},[c("div",{style:{"background-color":"#5ac95a","border-radius":"20%",padding:"10px","margin-right":"3%"}},[1==e.type?(n(),d("div",{key:0},v(e.msg),1)):2==e.type?(n(),d("div",{key:1})):g("v-if",!0)]),c("div",null,[m(h,{size:30},{default:f((()=>["10001"==e.uid?(n(),d("img",{key:0,src:"https://picss.sunbangyan.cn/2024/02/26/9013b468c3b207fc74825264ca088276.jpeg",alt:""})):(n(),d("img",{key:1,src:"https://picst.sunbangyan.cn/2024/02/26/8767d25d3f0d1f7190fff677d39bf723.jpeg",alt:""}))])),_:2},1024)])])):(n(),d("div",{key:1,class:"chatBoxMessageLeft"},[c("div",null,[m(h,{size:30},{default:f((()=>["10001"==e.uid?(n(),d("img",{key:0,src:"https://picss.sunbangyan.cn/2024/02/26/9013b468c3b207fc74825264ca088276.jpeg",alt:""})):(n(),d("img",{key:1,src:"https://picst.sunbangyan.cn/2024/02/26/8767d25d3f0d1f7190fff677d39bf723.jpeg",alt:""}))])),_:2},1024)]),c("div",{style:{"background-color":"#eee","border-radius":"20%",padding:"10px","margin-left":"3%"}},[1==e.type?(n(),d("div",{key:0},v(e.msg),1)):2==e.type?(n(),d("div",{key:1})):g("v-if",!0)])]))])))),256))])],512),g("  login  "),c("div",null,[m(_,{modelValue:a.login.dialog,"onUpdate:modelValue":o[3]||(o[3]=e=>a.login.dialog=e),title:"登录",width:"80%","show-close":!1,"close-on-click-modal":!1},{footer:f((()=>[c("div",{class:"dialog-footer"},[m(b,{type:"primary",onClick:i.loginUser},{default:f((()=>[y("登录")])),_:1},8,["onClick"])])])),default:f((()=>[m(V,{model:a.login},{default:f((()=>[m(k,{label:"账号"},{default:f((()=>[m(t,{modelValue:a.login.form.uid,"onUpdate:modelValue":o[1]||(o[1]=e=>a.login.form.uid=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),m(k,{label:"密码"},{default:f((()=>[m(t,{modelValue:a.login.form.psw,"onUpdate:modelValue":o[2]||(o[2]=e=>a.login.form.psw=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])])}],["__scopeId","data-v-bb3a11cc"]]);export{b as default};

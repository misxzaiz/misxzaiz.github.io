import{_ as A,r as p,G as D,H as J,o as K,c,a as e,h as F,t as a,n as f,F as k,d as M,w as $,X as O,f as d,b as j}from"./index-0g_e_Ani.js";const P={class:"empire-rise-game"},Q={key:0,class:"game-intro"},U={key:1,class:"game-container"},W={class:"game-header"},Y={class:"game-status"},Z=["disabled"],ee={key:0,class:"game-over-modal"},oe={class:"modal-content"},te={key:0},se={key:1},ae={class:"game-main"},le={class:"resources-panel"},ie={class:"resource-items"},ne={class:"resource"},ue={class:"resource"},ce={class:"resource"},de={class:"resource"},re={class:"resource"},pe={class:"resource"},ve={class:"resource"},fe={class:"resource"},he={key:0,class:"event-panel"},me={class:"event-effects"},ge={class:"game-tabs"},_e={class:"tab-buttons"},be={class:"tab-content"},ye={class:"buildings-grid"},ke={class:"building-costs"},Me={class:"building-produces"},qe=["onClick","disabled"],Ee={class:"tab-content"},we={class:"technologies-grid"},Ce={class:"tech-cost"},Be=["onClick","disabled"],$e={class:"tab-content"},Oe={class:"game-logs"},je={class:"log-timestamp"},Re={class:"log-message"},Te={__name:"EmpireRise",setup(xe){const R=p(!1),h=p(1),T=p(30),y=p(!1),E=p(!1),l=p({gold:100,food:100,wood:100,stone:50,population:10,happiness:80,science:0,military:10}),m=p([{id:"farm",name:"农场",count:0,cost:{gold:20,wood:30},produces:{food:10},description:"增加食物产量"},{id:"mine",name:"矿场",count:0,cost:{gold:20,stone:20},produces:{gold:8},description:"增加金币产量"},{id:"house",name:"住宅",count:0,cost:{gold:30,wood:40,stone:10},produces:{population:5},description:"增加人口上限"},{id:"lumbermill",name:"伐木场",count:0,cost:{gold:20,stone:15},produces:{wood:10},description:"增加木材产量"},{id:"quarry",name:"采石场",count:0,cost:{gold:20,wood:20},produces:{stone:8},description:"增加石材产量"},{id:"barracks",name:"兵营",count:0,cost:{gold:50,wood:30,stone:30},produces:{military:5},description:"增加军事力量"},{id:"market",name:"市场",count:0,cost:{gold:40,wood:20},produces:{gold:15,happiness:5},description:"增加金币产量和幸福度"},{id:"academy",name:"学院",count:0,cost:{gold:60,stone:40},produces:{science:10},description:"增加科研点数"},{id:"temple",name:"神庙",count:0,cost:{gold:40,stone:40},produces:{happiness:15},description:"大幅提升幸福度"}]),v=p([{id:"agriculture",name:"农业改良",cost:50,acquired:!1,effect:{farm:1.5},description:"农场效率提高50%"},{id:"mining",name:"采矿技术",cost:50,acquired:!1,effect:{mine:1.5},description:"矿场效率提高50%"},{id:"construction",name:"建筑技术",cost:60,acquired:!1,effect:{buildCostReduction:.2},description:"建筑成本降低20%"},{id:"military",name:"军事战略",cost:70,acquired:!1,effect:{barracks:1.5},description:"兵营效率提高50%"},{id:"trade",name:"贸易路线",cost:80,acquired:!1,effect:{market:1.5},description:"市场效率提高50%"},{id:"education",name:"教育系统",cost:100,acquired:!1,effect:{academy:1.5,scienceBoost:1.2},description:"学院效率提高50%，科研产出提高20%"},{id:"religion",name:"宗教信仰",cost:120,acquired:!1,effect:{temple:1.5,happinessBoost:1.2},description:"神庙效率提高50%，幸福度提高20%"},{id:"urbanization",name:"城市化",cost:150,acquired:!1,effect:{allBuildingsBoost:1.1},description:"所有建筑产出提高10%"}]),x=[{id:"goodHarvest",title:"丰收",description:"今年的收成特别好！",effect:{food:50,happiness:10}},{id:"drought",title:"干旱",description:"干旱导致粮食减产。",effect:{food:-30,happiness:-10}},{id:"goldRush",title:"淘金热",description:"发现了新的金矿！",effect:{gold:100}},{id:"plague",title:"瘟疫",description:"一场瘟疫席卷了你的城市。",effect:{population:-5,happiness:-20}},{id:"festival",title:"节日庆典",description:"举办了盛大的节日庆典。",effect:{gold:-20,happiness:25}},{id:"refugees",title:"难民到来",description:"一群难民请求在你的城市定居。",effect:{population:8,food:-20}},{id:"invention",title:"重大发明",description:"你的学者有了重大发明！",effect:{science:30}},{id:"trade",title:"贸易繁荣",description:"贸易路线繁荣发展。",effect:{gold:40,happiness:5}},{id:"bandit",title:"强盗袭击",description:"一群强盗袭击了你的城市。",effect:{gold:-30,military:-5,happiness:-5}}],g=p(null),_=p({cityName:"新都",difficulty:"normal",populationCap:D(()=>10+m.value.find(t=>t.id==="house").count*5),buildingMultipliers:{}}),q=p([]),n=D(()=>{const t={gold:5,food:5,wood:5,stone:3,population:0,happiness:0,science:0,military:0};m.value.forEach(i=>{if(i.count>0&&i.produces){const X=_.value.buildingMultipliers[i.id]||1;Object.keys(i.produces).forEach(z=>{t[z]+=i.produces[z]*i.count*X})}});const o=v.value.find(i=>i.id==="urbanization");o&&o.acquired&&Object.keys(t).forEach(i=>{t[i]*=o.effect.allBuildingsBoost});const s=v.value.find(i=>i.id==="education");s&&s.acquired&&(t.science*=s.effect.scienceBoost);const u=v.value.find(i=>i.id==="religion");return u&&u.acquired&&(t.happiness*=u.effect.happinessBoost),t.food-=l.value.population*1.5,t}),C=t=>{const o=v.value.find(i=>i.id==="construction"),s=o&&o.acquired?1-o.effect.buildCostReduction:1,u={};return Object.keys(t.cost).forEach(i=>{u[i]=Math.floor(t.cost[i]*s)}),u},N=t=>Object.keys(t).every(o=>l.value[o]>=t[o]),G=t=>{const o=C(t);N(o)&&(Object.keys(o).forEach(s=>{l.value[s]-=o[s]}),t.count+=1,w(),r(`建造了新的${t.name}`))},L=t=>{l.value.science>=t.cost&&!t.acquired&&(l.value.science-=t.cost,t.acquired=!0,w(),r(`研究完成：${t.name}`))},w=()=>{const t={};m.value.forEach(o=>{t[o.id]=1}),v.value.forEach(o=>{o.acquired&&o.effect&&Object.keys(o.effect).forEach(s=>{m.value.some(u=>u.id===s)&&(t[s]=o.effect[s])})}),_.value.buildingMultipliers=t},r=t=>{const o=`第 ${h.value} 回合`;q.value.unshift({message:t,timestamp:o}),q.value.length>30&&q.value.pop()},V=()=>{if(Math.random()<.2){const t=x[Math.floor(Math.random()*x.length)];g.value=t,Object.keys(t.effect).forEach(o=>{l.value[o]+=t.effect[o],l.value[o]<0&&(l.value[o]=0)}),r(`事件：${t.title} - ${t.description}`)}else g.value=null},H=()=>{Object.keys(n.value).forEach(t=>{l.value[t]+=n.value[t]}),l.value.population>_.value.populationCap&&(l.value.population=_.value.populationCap,r("人口已达到上限！建造更多住宅以增加人口上限。")),Object.keys(l.value).forEach(t=>{l.value[t]<0&&(l.value[t]=0)}),n.value.food<0&&l.value.food<=0&&(l.value.population=Math.max(0,l.value.population-2),l.value.happiness-=10,r("你的城市正在挨饿！人口减少了。")),l.value.happiness<30&&(r("你的人民非常不满！可能会有叛乱发生。"),Math.random()<.3&&(l.value.population=Math.max(0,l.value.population-1),r("部分居民离开了你的城市。"))),V(),h.value++,I(),r(`第 ${h.value} 回合开始`)},I=()=>{if(h.value>T.value){y.value=!0,r("游戏结束：时间结束");return}if(l.value.population<=0){y.value=!0,r("游戏结束：你的城市已经无人居住");return}if(l.value.population>=200&&v.value.filter(t=>t.acquired).length>=v.value.length*.8&&l.value.happiness>=80){y.value=!0,E.value=!0,r("游戏结束：恭喜你建立了繁荣的帝国！");return}},S=()=>{R.value=!0,y.value=!1,E.value=!1,h.value=1,l.value={gold:100,food:100,wood:100,stone:50,population:10,happiness:80,science:0,military:10},m.value.forEach(t=>{t.count=0}),v.value.forEach(t=>{t.acquired=!1}),g.value=null,q.value=[],w(),r("游戏开始！建设你的帝国吧！")},b=p("buildings"),B=t=>{b.value=t};return J(()=>l.value.population,(t,o)=>{t>o&&Math.random()<.3&&(l.value.happiness=Math.max(0,l.value.happiness-2))}),K(()=>{w()}),(t,o)=>(d(),c("div",P,[R.value?(d(),c("div",U,[e("div",W,[e("h1",null,"帝国崛起 - "+a(_.value.cityName),1),e("div",Y,[e("span",null,"第 "+a(h.value)+" 回合 / "+a(T.value),1),e("button",{onClick:H,disabled:y.value,class:"end-turn-btn"},"结束回合",8,Z)])]),y.value?(d(),c("div",ee,[e("div",oe,[e("h2",null,a(E.value?"胜利！":"游戏结束"),1),E.value?(d(),c("p",te,"恭喜你建立了一个繁荣的帝国！")):(d(),c("p",se,"你的帝国没能繁荣发展...")),o[5]||(o[5]=e("p",null,"最终成绩:",-1)),e("ul",null,[e("li",null,"生存回合: "+a(h.value),1),e("li",null,"最终人口: "+a(l.value.population),1),e("li",null,"建筑总数: "+a(m.value.reduce((s,u)=>s+u.count,0)),1),e("li",null,"科技进度: "+a(Math.round(v.value.filter(s=>s.acquired).length/v.value.length*100))+"%",1)]),e("button",{onClick:S,class:"restart-button"},"重新开始")])])):F("",!0),e("div",ae,[e("div",le,[o[6]||(o[6]=e("h3",null,"资源",-1)),e("div",ie,[e("div",ne,[e("span",null,"💰 金币: "+a(Math.floor(l.value.gold)),1),e("span",{class:f(["production",{positive:n.value.gold>0,negative:n.value.gold<0}])}," ("+a(n.value.gold>0?"+":"")+a(Math.floor(n.value.gold))+"/回合) ",3)]),e("div",ue,[e("span",null,"🌽 食物: "+a(Math.floor(l.value.food)),1),e("span",{class:f(["production",{positive:n.value.food>0,negative:n.value.food<0}])}," ("+a(n.value.food>0?"+":"")+a(Math.floor(n.value.food))+"/回合) ",3)]),e("div",ce,[e("span",null,"🪵 木材: "+a(Math.floor(l.value.wood)),1),e("span",{class:f(["production",{positive:n.value.wood>0,negative:n.value.wood<0}])}," ("+a(n.value.wood>0?"+":"")+a(Math.floor(n.value.wood))+"/回合) ",3)]),e("div",de,[e("span",null,"🪨 石材: "+a(Math.floor(l.value.stone)),1),e("span",{class:f(["production",{positive:n.value.stone>0,negative:n.value.stone<0}])}," ("+a(n.value.stone>0?"+":"")+a(Math.floor(n.value.stone))+"/回合) ",3)]),e("div",re,[e("span",null,"👥 人口: "+a(Math.floor(l.value.population))+" / "+a(_.value.populationCap),1)]),e("div",pe,[e("span",null,"😊 幸福度: "+a(Math.floor(l.value.happiness)),1)]),e("div",ve,[e("span",null,"🔬 科研: "+a(Math.floor(l.value.science)),1),e("span",{class:f(["production",{positive:n.value.science>0}])}," ("+a(n.value.science>0?"+":"")+a(Math.floor(n.value.science))+"/回合) ",3)]),e("div",fe,[e("span",null,"⚔️ 军事: "+a(Math.floor(l.value.military)),1)])])]),g.value?(d(),c("div",he,[e("h3",null,"事件: "+a(g.value.title),1),e("p",null,a(g.value.description),1),e("div",me,[(d(!0),c(k,null,M(g.value.effect,(s,u)=>(d(),c("div",{key:u,class:"event-effect"},a(u)+": "+a(s>0?"+":"")+a(s),1))),128))])])):F("",!0),e("div",ge,[e("div",_e,[e("button",{class:f(["tab-button",{active:b.value==="buildings"}]),onClick:o[0]||(o[0]=s=>B("buildings"))},"建筑",2),e("button",{class:f(["tab-button",{active:b.value==="technologies"}]),onClick:o[1]||(o[1]=s=>B("technologies"))},"科技",2),e("button",{class:f(["tab-button",{active:b.value==="logs"}]),onClick:o[2]||(o[2]=s=>B("logs"))},"日志",2)]),$(e("div",be,[o[9]||(o[9]=e("h3",null,"城市建筑",-1)),e("div",ye,[(d(!0),c(k,null,M(m.value,s=>(d(),c("div",{key:s.id,class:"building-card"},[e("h4",null,a(s.name)+" ("+a(s.count)+")",1),e("p",null,a(s.description),1),e("div",ke,[o[7]||(o[7]=j(" 成本: ")),(d(!0),c(k,null,M(C(s),(u,i)=>(d(),c("span",{key:i,class:f({"not-enough":l.value[i]<u})},a(i)+": "+a(u),3))),128))]),e("div",Me,[o[8]||(o[8]=j(" 产出: ")),(d(!0),c(k,null,M(s.produces,(u,i)=>(d(),c("span",{key:i},a(i)+": +"+a(u*(_.value.buildingMultipliers[s.id]||1)),1))),128))]),e("button",{onClick:u=>G(s),disabled:!N(C(s))}," 建造 ",8,qe)]))),128))])],512),[[O,b.value==="buildings"]]),$(e("div",Ee,[o[11]||(o[11]=e("h3",null,"科技研究",-1)),e("div",we,[(d(!0),c(k,null,M(v.value,s=>(d(),c("div",{key:s.id,class:f(["tech-card",{"tech-acquired":s.acquired}])},[e("h4",null,a(s.name),1),e("p",null,a(s.description),1),e("div",Ce,[o[10]||(o[10]=j(" 研究点数: ")),e("span",{class:f({"not-enough":l.value.science<s.cost})},a(s.cost),3)]),e("button",{onClick:u=>L(s),disabled:s.acquired||l.value.science<s.cost},a(s.acquired?"已研究":"研究"),9,Be)],2))),128))])],512),[[O,b.value==="technologies"]]),$(e("div",$e,[o[12]||(o[12]=e("h3",null,"游戏日志",-1)),e("div",Oe,[(d(!0),c(k,null,M(q.value,(s,u)=>(d(),c("div",{key:u,class:"log-entry"},[e("span",je,a(s.timestamp),1),e("span",Re,a(s.message),1)]))),128))])],512),[[O,b.value==="logs"]])])])])):(d(),c("div",Q,[o[3]||(o[3]=e("h1",null,"帝国崛起",-1)),o[4]||(o[4]=e("p",null,"建设你自己的帝国，管理资源，研究科技，应对各种事件和挑战！",-1)),e("button",{onClick:S,class:"start-button"},"开始新游戏")]))]))}},Se=A(Te,[["__scopeId","data-v-3a779dd4"]]);export{Se as default};

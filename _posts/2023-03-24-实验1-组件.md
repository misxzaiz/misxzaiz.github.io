---
layout:			post
title:			"微信小程序组件"
subtitle: 		"微信小程序组件"
author:			"XiaoZaiz"
header-style: 	text
catalog:      	true
tags:
    - 微信小程序
    - 组件
---

# 组件

```js
// app.js
App({
  globalData: {
    url: "http://8.130.73.113"
  }
})
```

## 一、articlesShow组件

### 1.1 articlesShow.wxml

```html
<!--components/articlesShow-component/articlesShow-component.wxml-->
<view wx:for="{{ articles }}" class="articleBox">
  <navigator url="{{ url + '?id=' + item.id  }}">
    <view class="title">
      <text>{{ item.title }}</text>
    </view>
    <view style="color: rgb(136, 136, 136);">
      <text>{{ item.created_at }}</text>
      <text class="aothur">{{ item.author }}</text>
    </view>
  </navigator>
</view>
```

### 1.2 articlesShow.js

```js
// components/articlesShow-component/articlesShow-component.js
// 获取app
const app = getApp()
Component({
  /**
   * 组件的属性列表
   */
  properties: {
    url: {
      type: String,
      value: ''
    }
  },
  /**
   * 组件的初始数据
   */
  data: {
    articles: []
  },
  // 监听点击事件实现跳转
  methods: {

  },
  /**
   * 组件的方法列表
   */
  attached() {
    wx.request({
      url: app.globalData.url + '/article/allbutnocontent',
      method: 'get',
      success: res => {
        // 在响应成功后遍历返回的数据并处理时间
        res.data.forEach(function(item) {
          // 将时间字符串转换成Date对象
          var dateObj = new Date(item.created_at);
      
          // 从Date对象中获取月份和日期，并组装成新的字符串
          var monthDay = (dateObj.getMonth() + 1).toString().padStart(2, '0') + '-' + dateObj.getDate().toString().padStart(2, '0');
      
          // 将新的格式化后的日期重新赋值给数组对应的元素的time属性
          item.created_at = monthDay;
        });
        this.setData({
          articles: res.data
        })
      },
      fail: err => {
        console.log(err)
      }
    })
  }
})
```

### 1.3 articlesShow.wxss

```css
/* components/articlesShow-component/articlesShow-component.wxss */
.articleBox {
  height: 150rpx;
  padding: 20rpx;
  border-bottom: solid black 1rpx;
}
.title {
  height: 115rpx;
  font-size: larger;
  font-weight: bolder;
}
.aothur {
  padding-left: 20rpx;
}
```

### 1.4 articlesShow.json

```json
{
  "component": true,
  "usingComponents": {}
}
```

### 1.5 使用自定义组件

在需要使用自定义组件的页面的`json`文件中添加如下代码：

```json
{
  "usingComponents": {
    "articlesShow-component": "/components/articlesShow-component/articlesShow-component"
  }
}
```

接着就可以在`wxml`文件中按照自定义组件的标签名来使用它了：

```html
<articlesShow-component url="/pages/contentShow/contentShow"></articlesShow-component>
```

## 二、contentShow文章详情

### 2.1 contentShow.wxml

```html
<!--pages/contentShow/contentShow.wxml-->
<view style="padding: 20rpx;">
  <view class="title">
    <text>{{ article.title }}</text>
  </view>
  <view style="color: rgb(151, 151, 151);height: 60rpx;">
    <text style="padding-right: 20rpx;">{{ article.created_at }}</text>
    <text>{{ article.author }}</text>
  </view>
  <view>
    <rich-text nodes="{{ article.content }}"></rich-text>
  </view>
</view>
```

### 2.2 contentShow.js

```js
// pages/contentShow/contentShow.js
// 获取app实例
const app = getApp()
Page({

  /**
   * 页面的初始数据
   */
  data: {
    article: {}
  },

  /**
   * 生命周期函数--监听页面加载
   */
  onLoad(options) {
    let that = this;
    wx.request({
      url: app.globalData.url + '/article/' + options.id,
      success: function(res){
        // 将时间字符串转换成Date对象
        let dateObj = new Date(res.data.created_at);
        // 从Date对象中获取月份和日期，并组装成新的字符串
        let monthDay = (dateObj.getMonth() + 1).toString().padStart(2, '0') + '-' + dateObj.getDate().toString().padStart(2, '0');
        // 将新的格式化后的日期重新赋值给数组对应的元素的time属性
        res.data.created_at = monthDay;
        that.setData({
        
          article: res.data
        })
      }
    })
  },

  /**
   * 生命周期函数--监听页面初次渲染完成
   */
  onReady() {

  },

  /**
   * 生命周期函数--监听页面显示
   */
  onShow() {

  },

  /**
   * 生命周期函数--监听页面隐藏
   */
  onHide() {

  },

  /**
   * 生命周期函数--监听页面卸载
   */
  onUnload() {

  },

  /**
   * 页面相关事件处理函数--监听用户下拉动作
   */
  onPullDownRefresh() {

  },

  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom() {

  },

  /**
   * 用户点击右上角分享
   */
  onShareAppMessage() {

  }
})
```

### 2.3 contentShow.wxss

```css
/* pages/contentShow/contentShow.wxss */
.title {
  height: 150rpx;
  font-weight: bold;
  font-size: x-large;
}
.created_at {
  padding-right: 20rpx;
}
```

### 2.4 contentShow.json

```json
{
  "usingComponents": {}
}
```



